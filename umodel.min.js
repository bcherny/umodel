!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("umodel",[],b):a.umodel=b()}(this,function(){var a,b,c={}.hasOwnProperty;return b={extend:function(a,b){var d;for(d in b)c.call(b,d)&&(a[d]=b[d]);return a},trim:function(){var a,b;return"".trim?function(a){return a.trim()}:(a=/^\s\s*/,b=/\s\s*$/,function(c){return c.replace(a,"").replace(b,"")})}()},a=function(){function a(a,c){this._data=null!=a?a:{},this.options={separator:"/"},c&&b.extend(this.options,c),this.events={}}return a.prototype.get=function(a){return this.trigger("get",a),this._get(this._split(a),this._data)},a.prototype.set=function(a,b){var c;return c=this._get(this._split(a),this._data),this._set(this._split(a),b,!1,this._data),this.trigger("set",a,b,c)},a.prototype.setnx=function(a,b){var c;return c=this._get(this._split(a),this._data),this._set(this._split(a),b,!0,this._data),this.trigger("setnx",a,b,c)},a.prototype.on=function(a,b){var c,d;if(b)return this._on(a,b);d=[];for(c in a)b=a[c],d.push(this._on(c,b));return d},a.prototype.trigger=function(a,b,c,d){var e,f,g,h,i;if(null==b&&(b="*"),b=this._normalize(b),a in this.events){h=this.events[a],i=[];for(e in h)g=h[e],"*"===e||0===(b+"/").indexOf(e+"/")?i.push(function(){var a,e,h;for(h=[],a=0,e=g.length;e>a;a++)f=g[a],null!=d?h.push(f.call(this,b,c,d)):h.push(f.call(this,b,c));return h}.call(this)):i.push(void 0);return i}},a.prototype._get=function(a,b,c){var d;return null==c&&(c=[]),d=a.shift(),d?d in b?(c.push(d),this._get(a,b[d],c)):void 0:b},a.prototype._set=function(a,b,c,d,e){var f;return null==c&&(c=!1),null==e&&(e=[]),f=a.shift(),a.length?(f in d||(d[f]={}),e.push(f),this._set(a,b,c,d[f],e)):c&&f in d?void 0:d[f]=b},a.prototype._on=function(a,c){var d,e,f,g,h,i,j;for(f=a.split(":"),e=f[0].split(" "),g=this._normalize(f[1]||"*"),j=[],h=0,i=e.length;i>h;h++)d=e[h],d=b.trim(d),d in this.events||(this.events[d]={}),g in this.events[d]||(this.events[d][g]=[]),j.push(this.events[d][g].push(c));return j},a.prototype._normalize=function(a){var c;return c=this.options.separator,a=b.trim(a),a.charAt(0)===c&&(a=a.slice(1)),a.charAt(a.length-1)===c&&(a=a.slice(0,-1)),a},a.prototype._split=function(a){return this._normalize(a).split(this.options.separator)},a}()});